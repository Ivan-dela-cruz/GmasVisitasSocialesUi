import{g as u,a2 as S,r as y,j as e,w,a8 as g,a9 as j,aa as k,y as f,P as C,u as E,M as U,G as o,S as s,ab as L,T as v,a as r,ac as A,N as D,t as z,m as N,o as x}from"./index-DlGxA0AR.js";import{B as P}from"./Building-Bnb-owyJ.js";import{L as W}from"./Lock-DksMLywD.js";import{u as B,C as R}from"./useConfirmDialog-B4uIsMqU.js";import{d as $,a as M}from"./users-C4kYjLV8.js";import{S as G}from"./Switch-DSnvG_gT.js";import{T as K}from"./Trash-BXUkiIWs.js";function b(a){let i=0;return a.includes("/password")?i=2:a.includes("/companies")?i=1:a.includes("/personal")&&(i=0),i}function I({userId:a}){const i=u(),{pathname:n}=S(),[t,d]=y.useState(b(n)),c=(p,h)=>{d(p),i(h)};return y.useEffect(()=>{d(b(n))},[n]),e.jsxs(w,{component:"nav",sx:{p:0,"& .MuiListItemIcon-root":{minWidth:32,color:"secondary.main"}},children:[e.jsxs(g,{selected:t===0,onClick:()=>c(0,`/apps/users/${a}/profile/personal`),children:[e.jsx(j,{children:e.jsx(k,{size:18})}),e.jsx(f,{primary:"Información Personal"})]}),e.jsxs(g,{selected:t===1,onClick:()=>c(1,`/apps/users/${a}/profile/companies`),children:[e.jsx(j,{children:e.jsx(P,{size:18})}),e.jsx(f,{primary:"Empresas Asignadas"})]}),e.jsxs(g,{selected:t===2,onClick:()=>c(2,`/apps/users/${a}/profile/password`),children:[e.jsx(j,{children:e.jsx(W,{size:18})}),e.jsx(f,{primary:"Cambiar Contraseña"})]})]})}I.propTypes={userId:C.string};function F({user:a}){const i=E(),n=u(),{dialogState:t,openDialog:d,closeDialog:c}=B(),p=async()=>{d({title:"Eliminar Usuario",message:`¿Está seguro de eliminar el usuario "${a==null?void 0:a.userName}"? Esta acción no se puede deshacer.`,severity:"error",confirmText:"Eliminar",onConfirm:async()=>{try{await $(a.id),x({open:!0,message:"Usuario eliminado exitosamente",variant:"alert",alert:{color:"success"}}),n("/apps/users/list")}catch{x({open:!0,message:"Error al eliminar el usuario",variant:"alert",alert:{color:"error"}})}}})},h=async l=>{const m=l.target.checked;try{await M(a.id,m),x({open:!0,message:`Usuario ${m?"activado":"desactivado"} exitosamente`,variant:"alert",alert:{color:"success"}})}catch{x({open:!0,message:"Error al cambiar el estado del usuario",variant:"alert",alert:{color:"error"}})}},T=l=>l?l.split(" ").map(m=>m[0]).join("").toUpperCase().substring(0,2):"U";return e.jsxs(U,{children:[e.jsxs(o,{container:!0,spacing:3,children:[e.jsx(o,{item:!0,xs:12,children:e.jsxs(s,{spacing:1.5,alignItems:"center",children:[e.jsx(L,{alt:a==null?void 0:a.fullName,sx:{width:100,height:100,border:"1px dashed",fontSize:"2rem",bgcolor:i.palette.mode===v.DARK?"primary.dark":"primary.lighter",color:"primary.main"},children:T(a==null?void 0:a.fullName)}),e.jsxs(s,{spacing:.5,alignItems:"center",children:[e.jsx(r,{variant:"h6",sx:{fontWeight:600},children:(a==null?void 0:a.fullName)||"Usuario"}),e.jsxs(r,{variant:"body2",color:"secondary",children:[a==null?void 0:a.userName," - ",(a==null?void 0:a.role)||"User"]})]})]})}),e.jsx(o,{item:!0,xs:6,children:e.jsxs(s,{direction:"row",spacing:1,alignItems:"center",children:[e.jsx(A,{size:18,color:i.palette.text.secondary,variant:"Bulk"}),e.jsxs(s,{spacing:0,children:[e.jsx(r,{variant:"caption",color:"text.secondary",sx:{fontSize:"0.7rem"},children:"Registrado"}),e.jsx(r,{variant:"body2",sx:{fontWeight:500},children:a!=null&&a.createdAt?new Date(a.createdAt).toLocaleDateString("es-ES",{day:"numeric",month:"short",year:"numeric"}):"N/A"})]})]})}),e.jsx(o,{item:!0,xs:6,children:e.jsx(s,{direction:"row",spacing:1,alignItems:"center",children:e.jsx(s,{spacing:0,children:e.jsx(D,{control:e.jsx(G,{checked:(a==null?void 0:a.isActive)||!1,onChange:h,size:"medium"}),label:e.jsx(r,{variant:"body2",sx:{fontWeight:500},children:a!=null&&a.isActive?"Activo":"Inactivo"}),sx:{m:0,mt:.25}})})})}),e.jsx(o,{item:!0,xs:12,children:e.jsx(I,{userId:a==null?void 0:a.id})}),e.jsx(o,{item:!0,xs:12,children:e.jsx(z,{sx:{my:1}})}),e.jsx(o,{item:!0,xs:12,children:e.jsxs(s,{spacing:1.5,children:[e.jsx(r,{variant:"h6",color:"error.main",sx:{fontWeight:600},children:"Zona de Peligro"}),e.jsxs(s,{spacing:2,sx:{p:2,borderRadius:1,border:"1px solid",borderColor:"error.light",bgcolor:i.palette.mode===v.DARK?"error.darker":"error.lighter"},children:[e.jsxs(s,{spacing:.5,children:[e.jsx(r,{variant:"subtitle1",sx:{fontWeight:600},children:"Eliminar este usuario"}),e.jsx(r,{variant:"body2",color:"text.secondary",children:"Una vez eliminado, no hay vuelta atrás."})]}),e.jsx(N,{variant:"contained",color:"error",startIcon:e.jsx(K,{}),onClick:p,sx:{width:"fit-content",fontWeight:600,boxShadow:"none","&:hover":{boxShadow:"none"}},children:"Eliminar"})]})]})})]}),e.jsx(R,{open:t.open,title:t.title,message:t.message,onConfirm:t.onConfirm,onCancel:c,confirmText:t.confirmText,cancelText:t.cancelText,severity:t.severity})]})}F.propTypes={user:C.object};export{F as U};
