import{g as L,R as B,r as W,j as e,M as C,B as q,a as o,G as t,F as x,k as h,l as m,S as P,m as y,o as p}from"./index-DlGxA0AR.js";import{u as I,C as d}from"./index.esm-DuBBEoLH.js";import{b as F,i as A}from"./employees-BnEvMwow.js";import{u as k}from"./catalogs-BiuMSa0N.js";import{C as E}from"./CircularProgress-9Q1cfhaT.js";import{T as n}from"./TextField-Dbihm-yT.js";import{I as j}from"./InputLabel-CAS4qYAm.js";import{F as O}from"./FormHelperText-BjerNUfA.js";const $=({employee:a=null,isEdit:u=!1})=>{const f=L(),[b,v]=B.useState(!1),{catalogs:g,isLoading:c}=k(),{control:l,handleSubmit:S,reset:N,formState:{errors:s}}=I({defaultValues:{identification:"",firstName:"",middleName:"",lastName:"",secondLastName:"",dateBirth:"",idSex:"",idTypeDisability:"",degreeDisability:"",idCivilState:"",idEducationLevel:"",cellphoneNumber:"",degreeObtained:"",emergencyContact:"",emergencyContactPhone:"",status:!0}});W.useEffect(()=>{a&&u&&N({identification:a.identification||"",firstName:a.firstName||"",middleName:a.middleName||"",lastName:a.lastName||"",secondLastName:a.secondLastName||"",dateBirth:a.dateBirth?a.dateBirth.split("T")[0]:"",idSex:a.idSex||"",idTypeDisability:a.idTypeDisability||"",degreeDisability:a.degreeDisability||"",idCivilState:a.idCivilState||"",idEducationLevel:a.idEducationLevel||"",cellphoneNumber:a.cellphoneNumber||"",degreeObtained:a.degreeObtained||"",emergencyContact:a.emergencyContact||"",emergencyContactPhone:a.emergencyContactPhone||"",status:a.status??!0})},[a,u,N]);const T=async r=>{v(!0);try{const i={...r,id:a.id,idSex:r.idSex?Number(r.idSex):null,idTypeDisability:r.idTypeDisability?Number(r.idTypeDisability):null,degreeDisability:r.degreeDisability?Number(r.degreeDisability):null,idCivilState:r.idCivilState?Number(r.idCivilState):null,idEducationLevel:r.idEducationLevel?Number(r.idEducationLevel):null,dateBirth:r.dateBirth?`${r.dateBirth}T00:00:00`:null};u&&a?(await F(i),p({open:!0,message:"Empleado actualizado exitosamente",variant:"alert",alert:{color:"success"}})):(await A(i),p({open:!0,message:"Empleado creado exitosamente",variant:"alert",alert:{color:"success"}})),f("/apps/employees/list")}catch(i){p({open:!0,message:i.message||"Error al guardar el empleado",variant:"alert",alert:{color:"error"}})}finally{v(!1)}},D=()=>{f("/apps/employees/list")};return c?e.jsx(C,{title:u?"Editar Empleado":"Nuevo Empleado",children:e.jsxs(q,{display:"flex",justifyContent:"center",alignItems:"center",minHeight:"400px",children:[e.jsx(E,{}),e.jsx(o,{variant:"body1",sx:{ml:2},children:"Cargando catálogos..."})]})}):e.jsx(C,{title:u?"Editar Empleado":"Nuevo Empleado",children:e.jsx("form",{onSubmit:S(T),children:e.jsxs(t,{container:!0,spacing:3,children:[e.jsx(t,{item:!0,xs:12,children:e.jsx(o,{variant:"h5",gutterBottom:!0,children:"Información Personal"})}),e.jsx(t,{item:!0,xs:12,sm:6,md:3,children:e.jsx(d,{name:"identification",control:l,rules:{required:"La cédula es requerida",pattern:{value:/^[0-9]{10}$/,message:"La cédula debe tener 10 dígitos"}},render:({field:r})=>{var i;return e.jsx(n,{...r,fullWidth:!0,label:"Cédula *",error:!!s.identification,helperText:(i=s.identification)==null?void 0:i.message})}})}),e.jsx(t,{item:!0,xs:12,sm:6,md:3,children:e.jsx(d,{name:"firstName",control:l,rules:{required:"El primer nombre es requerido"},render:({field:r})=>{var i;return e.jsx(n,{...r,fullWidth:!0,label:"Primer Nombre *",error:!!s.firstName,helperText:(i=s.firstName)==null?void 0:i.message})}})}),e.jsx(t,{item:!0,xs:12,sm:6,md:3,children:e.jsx(d,{name:"middleName",control:l,render:({field:r})=>e.jsx(n,{...r,fullWidth:!0,label:"Segundo Nombre"})})}),e.jsx(t,{item:!0,xs:12,sm:6,md:3,children:e.jsx(d,{name:"lastName",control:l,rules:{required:"El apellido paterno es requerido"},render:({field:r})=>{var i;return e.jsx(n,{...r,fullWidth:!0,label:"Apellido Paterno *",error:!!s.lastName,helperText:(i=s.lastName)==null?void 0:i.message})}})}),e.jsx(t,{item:!0,xs:12,sm:6,md:3,children:e.jsx(d,{name:"secondLastName",control:l,render:({field:r})=>e.jsx(n,{...r,fullWidth:!0,label:"Apellido Materno"})})}),e.jsx(t,{item:!0,xs:12,sm:6,md:3,children:e.jsx(d,{name:"dateBirth",control:l,rules:{required:"La fecha de nacimiento es requerida"},render:({field:r})=>{var i;return e.jsx(n,{...r,fullWidth:!0,label:"Fecha de Nacimiento *",type:"date",InputLabelProps:{shrink:!0},error:!!s.dateBirth,helperText:(i=s.dateBirth)==null?void 0:i.message})}})}),e.jsx(t,{item:!0,xs:12,sm:6,md:3,children:e.jsx(d,{name:"idSex",control:l,rules:{required:"El sexo es requerido"},render:({field:r})=>e.jsxs(x,{fullWidth:!0,error:!!s.idSex,disabled:c,children:[e.jsx(j,{children:"Sexo *"}),e.jsxs(h,{...r,label:"Sexo *",children:[e.jsx(m,{value:"",children:"Seleccionar"}),g.sex.map(i=>e.jsx(m,{value:i.id,children:i.description},i.id))]}),s.idSex&&e.jsx(O,{children:s.idSex.message})]})})}),e.jsx(t,{item:!0,xs:12,sm:6,md:3,children:e.jsx(d,{name:"idCivilState",control:l,render:({field:r})=>e.jsxs(x,{fullWidth:!0,disabled:c,children:[e.jsx(j,{children:"Estado Civil"}),e.jsxs(h,{...r,label:"Estado Civil",children:[e.jsx(m,{value:"",children:"Ninguno"}),g.maritalStatus.map(i=>e.jsx(m,{value:i.id,children:i.description},i.id))]})]})})}),e.jsx(t,{item:!0,xs:12,children:e.jsx(o,{variant:"h5",gutterBottom:!0,sx:{mt:2},children:"Información de Contacto"})}),e.jsx(t,{item:!0,xs:12,sm:6,md:4,children:e.jsx(d,{name:"cellphoneNumber",control:l,rules:{required:"El celular es requerido",pattern:{value:/^[0-9]{10}$/,message:"El celular debe tener 10 dígitos"}},render:({field:r})=>{var i;return e.jsx(n,{...r,fullWidth:!0,label:"Celular *",error:!!s.cellphoneNumber,helperText:(i=s.cellphoneNumber)==null?void 0:i.message})}})}),e.jsx(t,{item:!0,xs:12,sm:6,md:4,children:e.jsx(d,{name:"emergencyContact",control:l,render:({field:r})=>e.jsx(n,{...r,fullWidth:!0,label:"Contacto de Emergencia"})})}),e.jsx(t,{item:!0,xs:12,sm:6,md:4,children:e.jsx(d,{name:"emergencyContactPhone",control:l,rules:{pattern:{value:/^[0-9]{10}$/,message:"El teléfono debe tener 10 dígitos"}},render:({field:r})=>{var i;return e.jsx(n,{...r,fullWidth:!0,label:"Teléfono de Emergencia",error:!!s.emergencyContactPhone,helperText:(i=s.emergencyContactPhone)==null?void 0:i.message})}})}),e.jsx(t,{item:!0,xs:12,children:e.jsx(o,{variant:"h5",gutterBottom:!0,sx:{mt:2},children:"Información Académica"})}),e.jsx(t,{item:!0,xs:12,sm:6,md:4,children:e.jsx(d,{name:"idEducationLevel",control:l,render:({field:r})=>e.jsxs(x,{fullWidth:!0,disabled:c,children:[e.jsx(j,{children:"Nivel de Educación"}),e.jsxs(h,{...r,label:"Nivel de Educación",children:[e.jsx(m,{value:"",children:"Ninguno"}),g.academicLevel.map(i=>e.jsx(m,{value:i.id,children:i.description},i.id))]})]})})}),e.jsx(t,{item:!0,xs:12,sm:6,md:4,children:e.jsx(d,{name:"degreeObtained",control:l,render:({field:r})=>e.jsx(n,{...r,fullWidth:!0,label:"Título Obtenido"})})}),e.jsx(t,{item:!0,xs:12,children:e.jsx(o,{variant:"h5",gutterBottom:!0,sx:{mt:2},children:"Información de Discapacidad"})}),e.jsx(t,{item:!0,xs:12,sm:6,md:4,children:e.jsx(d,{name:"idTypeDisability",control:l,render:({field:r})=>e.jsxs(x,{fullWidth:!0,disabled:c,children:[e.jsx(j,{children:"Tipo de Discapacidad"}),e.jsxs(h,{...r,label:"Tipo de Discapacidad",children:[e.jsx(m,{value:"",children:"Ninguna"}),g.disabilityType.map(i=>e.jsx(m,{value:i.id,children:i.description},i.id))]})]})})}),e.jsx(t,{item:!0,xs:12,sm:6,md:4,children:e.jsx(d,{name:"degreeDisability",control:l,rules:{min:{value:0,message:"El grado debe ser mayor o igual a 0"},max:{value:100,message:"El grado debe ser menor o igual a 100"}},render:({field:r})=>{var i;return e.jsx(n,{...r,fullWidth:!0,label:"Grado de Discapacidad (%)",type:"number",inputProps:{min:0,max:100,step:.01},error:!!s.degreeDisability,helperText:(i=s.degreeDisability)==null?void 0:i.message})}})}),e.jsx(t,{item:!0,xs:12,sm:6,md:4,children:e.jsx(d,{name:"status",control:l,render:({field:r})=>e.jsxs(x,{fullWidth:!0,children:[e.jsx(j,{children:"Estado"}),e.jsxs(h,{...r,label:"Estado",value:r.value?"true":"false",onChange:i=>r.onChange(i.target.value==="true"),children:[e.jsx(m,{value:"true",children:"Activo"}),e.jsx(m,{value:"false",children:"Inactivo"})]})]})})}),e.jsx(t,{item:!0,xs:12,children:e.jsxs(P,{direction:"row",spacing:2,justifyContent:"flex-end",sx:{mt:3},children:[e.jsx(y,{variant:"outlined",color:"secondary",onClick:D,disabled:b,children:"Cancelar"}),e.jsx(y,{variant:"contained",type:"submit",disabled:b,children:b?e.jsx(E,{size:24}):u?"Actualizar":"Guardar"})]})})]})})})},K=$;export{K as E};
