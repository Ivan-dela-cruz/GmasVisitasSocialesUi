import{a1 as g,r as C,g as b,j as e,M as P,m as i,G as a,O as v,a as y,S as L,o as l}from"./index-DlGxA0AR.js";import{u as S,C as u}from"./index.esm-DuBBEoLH.js";import{e as T}from"./users-C4kYjLV8.js";import{A as k}from"./ArrowLeft-DgXiCSs-.js";import{T as x}from"./TextField-Dbihm-yT.js";import{C as z}from"./CircularProgress-9Q1cfhaT.js";import"./InputLabel-CAS4qYAm.js";import"./FormHelperText-BjerNUfA.js";function G(){const{user:t}=g(),[n,c]=C.useState(!1),f=b(),{control:d,handleSubmit:p,watch:w,reset:m,formState:{errors:o}}=S({defaultValues:{newPassword:"",confirmPassword:""}}),h=w("newPassword"),j=async r=>{if(r.newPassword!==r.confirmPassword){l({open:!0,message:"Las contraseñas no coinciden",variant:"alert",alert:{color:"warning"}});return}c(!0);try{await T(t.userName,r.newPassword),l({open:!0,message:"Contraseña actualizada exitosamente",variant:"alert",alert:{color:"success"}}),m()}catch(s){l({open:!0,message:s.message||"Error al cambiar la contraseña",variant:"alert",alert:{color:"error"}})}finally{c(!1)}};return e.jsx(P,{content:!1,title:"Cambiar Contraseña",secondary:e.jsx(i,{variant:"outlined",size:"small",startIcon:e.jsx(k,{}),onClick:()=>f("/apps/users/list"),sx:{fontWeight:600},children:"Regresar"}),sx:{"& .MuiInputLabel-root":{fontSize:"0.875rem"}},children:e.jsx("form",{onSubmit:p(j),children:e.jsxs(a,{container:!0,spacing:3,sx:{p:3},children:[e.jsx(a,{item:!0,xs:12,children:e.jsx(v,{severity:"info",children:"La contraseña debe tener al menos 6 caracteres."})}),e.jsx(a,{item:!0,xs:12,children:e.jsxs(y,{variant:"h6",gutterBottom:!0,children:["Usuario: ",e.jsx("strong",{children:t==null?void 0:t.userName})]})}),e.jsx(a,{item:!0,xs:12,sm:6,children:e.jsx(u,{name:"newPassword",control:d,rules:{required:"La contraseña es requerida",minLength:{value:6,message:"La contraseña debe tener al menos 6 caracteres"}},render:({field:r})=>{var s;return e.jsx(x,{...r,fullWidth:!0,label:"Nueva Contraseña *",type:"password",error:!!o.newPassword,helperText:(s=o.newPassword)==null?void 0:s.message})}})}),e.jsx(a,{item:!0,xs:12,sm:6,children:e.jsx(u,{name:"confirmPassword",control:d,rules:{required:"Confirme la contraseña",validate:r=>r===h||"Las contraseñas no coinciden"},render:({field:r})=>{var s;return e.jsx(x,{...r,fullWidth:!0,label:"Confirmar Contraseña *",type:"password",error:!!o.confirmPassword,helperText:(s=o.confirmPassword)==null?void 0:s.message})}})}),e.jsx(a,{item:!0,xs:12,children:e.jsxs(L,{direction:"row",justifyContent:"flex-end",spacing:2,children:[e.jsx(i,{variant:"outlined",color:"secondary",onClick:()=>m(),disabled:n,children:"Cancelar"}),e.jsx(i,{type:"submit",variant:"contained",disabled:n,children:n?e.jsx(z,{size:24}):"Cambiar Contraseña"})]})})]})})})}export{G as default};
